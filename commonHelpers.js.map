{"version":3,"file":"commonHelpers.js","sources":["../src/js/pixabay-api.js","../src/js/render-functions.js","../src/main.js"],"sourcesContent":["import axios from 'axios';\n\nexport class PixabayApi {\n  constructor() {\n    this.BASE_URL = 'https://pixabay.com';\n    this.API_KEY = '42308857-af265c382d366c65500552078';\n    this.perPage = 15;\n    axios.defaults.baseURL = this.BASE_URL;\n  }\n\n  async getImages(userQuery, userPage = 1) {\n    const params = new URLSearchParams({\n      key: this.API_KEY,\n      q: userQuery,\n      image_type: 'photo',\n      orientation: 'horizontal',\n      safesearch: true,\n      per_page: this.perPage,\n      page: userPage,\n    });\n\n    const res = await axios.get('/api/', { params });\n    return res.data;\n  }\n}\n","function templateCard({\n  webformatURL,\n  largeImageURL,\n  tags,\n  likes,\n  views,\n  comments,\n  downloads,\n}) {\n  return `      \n      <li class=\"card\">\n        <a href =\"${largeImageURL}\">\n        <img class=\"card-img\" src=\"${webformatURL}\" alt=\"${tags}\" >\n        <ul class=\"card-data\">\n          <li><h3>Likes</h3><p>${likes}</p></li>\n          <li><h3>Views</h3><p>${views}</p></li>\n          <li><h3>Comments</h3><p>${comments}</p></li>\n          <li><h3>Downloads</h3><p>${downloads}</p></li>\n        </ul>\n      </li>`;\n}\n\nexport function templateCards(images) {\n  return images.map(templateCard).join('');\n}\n","import { PixabayApi } from './js/pixabay-api';\nimport { templateCards } from './js/render-functions';\nimport iziToast from 'izitoast';\nimport SimpleLightbox from 'simplelightbox';\nimport 'izitoast/dist/css/iziToast.min.css';\nimport 'simplelightbox/dist/simple-lightbox.min.css';\n\nconst pixabayApi = new PixabayApi();\n\nconst lightbox = new SimpleLightbox('.gallery a');\n\nconst form = document.querySelector('.search-form');\nconst gallery = document.querySelector('.gallery');\nconst loader = document.querySelector('.loader');\nconst btnLoadMore = document.querySelector('.load-btn');\n\n// =======================================================\n\nlet query;\nlet page;\nlet maxPage;\n\nform.addEventListener('submit', onSearchSubmit);\nbtnLoadMore.addEventListener('click', onLoadMoreClick);\n\nasync function onSearchSubmit(event) {\n  event.preventDefault();\n  gallery.innerHTML = '';\n  query = event.target.query.value.trim();\n  page = 1;\n  showLoader();\n  hideLoadBtn();\n\n  try {\n    const data = await pixabayApi.getImages(query);\n    maxPage = Math.ceil(data.totalHits / pixabayApi.perPage);\n    const images = data.hits;\n    if (!images.length) {\n      throw new Error(\n        'Sorry, there are no images matching your search query. Please try again!'\n      );\n    }\n    renderCards(images);\n    checkBtnVisibleStatus();\n  } catch (error) {\n    showError(error.message);\n  }\n  hideLoader();\n  event.target.reset();\n}\n\nasync function onLoadMoreClick(event) {\n  page += 1;\n  hideLoadBtn();\n  showLoader();\n  const data = await pixabayApi.getImages(query, page);\n  renderCards(data.hits);\n  hideLoader();\n  checkBtnVisibleStatus();\n\n  const height = gallery.firstElementChild.getBoundingClientRect().height;\n  scrollBy({\n    behavior: 'smooth',\n    top: height * 2 + 10,\n  });\n}\n\nfunction showError(message) {\n  iziToast.error({\n    pauseOnHover: false,\n    position: 'topRight',\n    message,\n  });\n}\n\nfunction toggleLoader() {\n  loader.classList.toggle('hidden');\n}\n\nfunction showLoader() {\n  loader.classList.remove('hidden');\n}\nfunction hideLoader() {\n  loader.classList.add('hidden');\n}\n\nfunction showLoadBtn() {\n  btnLoadMore.classList.remove('hidden');\n}\nfunction hideLoadBtn() {\n  btnLoadMore.classList.add('hidden');\n}\n\nfunction checkBtnVisibleStatus() {\n  if (page >= maxPage) {\n    hideLoadBtn();\n    showError(\"We're sorry, but you've reached the end of search results.\");\n  } else {\n    showLoadBtn();\n  }\n}\n\nfunction renderCards(images) {\n  gallery.insertAdjacentHTML('beforeend', templateCards(images));\n  lightbox.refresh();\n}\n"],"names":["PixabayApi","axios","userQuery","userPage","params","templateCard","webformatURL","largeImageURL","tags","likes","views","comments","downloads","templateCards","images","pixabayApi","lightbox","SimpleLightbox","form","gallery","loader","btnLoadMore","query","page","maxPage","onSearchSubmit","onLoadMoreClick","event","showLoader","hideLoadBtn","data","renderCards","checkBtnVisibleStatus","error","showError","hideLoader","height","message","iziToast","showLoadBtn"],"mappings":"+vBAEO,MAAMA,CAAW,CACtB,aAAc,CACZ,KAAK,SAAW,sBAChB,KAAK,QAAU,qCACf,KAAK,QAAU,GACfC,EAAM,SAAS,QAAU,KAAK,QAC/B,CAED,MAAM,UAAUC,EAAWC,EAAW,EAAG,CACvC,MAAMC,EAAS,IAAI,gBAAgB,CACjC,IAAK,KAAK,QACV,EAAGF,EACH,WAAY,QACZ,YAAa,aACb,WAAY,GACZ,SAAU,KAAK,QACf,KAAMC,CACZ,CAAK,EAGD,OADY,MAAMF,EAAM,IAAI,QAAS,CAAE,OAAAG,CAAM,CAAE,GACpC,IACZ,CACH,CCxBA,SAASC,EAAa,CACpB,aAAAC,EACA,cAAAC,EACA,KAAAC,EACA,MAAAC,EACA,MAAAC,EACA,SAAAC,EACA,UAAAC,CACF,EAAG,CACD,MAAO;AAAA;AAAA,oBAEWL,CAAa;AAAA,qCACID,CAAY,UAAUE,CAAI;AAAA;AAAA,iCAE9BC,CAAK;AAAA,iCACLC,CAAK;AAAA,oCACFC,CAAQ;AAAA,qCACPC,CAAS;AAAA;AAAA,YAG9C,CAEO,SAASC,EAAcC,EAAQ,CACpC,OAAOA,EAAO,IAAIT,CAAY,EAAE,KAAK,EAAE,CACzC,CCjBA,MAAMU,EAAa,IAAIf,EAEjBgB,EAAW,IAAIC,EAAe,YAAY,EAE1CC,EAAO,SAAS,cAAc,cAAc,EAC5CC,EAAU,SAAS,cAAc,UAAU,EAC3CC,EAAS,SAAS,cAAc,SAAS,EACzCC,EAAc,SAAS,cAAc,WAAW,EAItD,IAAIC,EACAC,EACAC,EAEJN,EAAK,iBAAiB,SAAUO,CAAc,EAC9CJ,EAAY,iBAAiB,QAASK,CAAe,EAErD,eAAeD,EAAeE,EAAO,CACnCA,EAAM,eAAc,EACpBR,EAAQ,UAAY,GACpBG,EAAQK,EAAM,OAAO,MAAM,MAAM,KAAI,EACrCJ,EAAO,EACPK,IACAC,IAEA,GAAI,CACF,MAAMC,EAAO,MAAMf,EAAW,UAAUO,CAAK,EAC7CE,EAAU,KAAK,KAAKM,EAAK,UAAYf,EAAW,OAAO,EACvD,MAAMD,EAASgB,EAAK,KACpB,GAAI,CAAChB,EAAO,OACV,MAAM,IAAI,MACR,0EACR,EAEIiB,EAAYjB,CAAM,EAClBkB,GACD,OAAQC,EAAO,CACdC,EAAUD,EAAM,OAAO,CACxB,CACDE,IACAR,EAAM,OAAO,OACf,CAEA,eAAeD,EAAgBC,EAAO,CACpCJ,GAAQ,EACRM,IACAD,IACA,MAAME,EAAO,MAAMf,EAAW,UAAUO,EAAOC,CAAI,EACnDQ,EAAYD,EAAK,IAAI,EACrBK,IACAH,IAEA,MAAMI,EAASjB,EAAQ,kBAAkB,sBAAqB,EAAG,OACjE,SAAS,CACP,SAAU,SACV,IAAKiB,EAAS,EAAI,EACtB,CAAG,CACH,CAEA,SAASF,EAAUG,EAAS,CAC1BC,EAAS,MAAM,CACb,aAAc,GACd,SAAU,WACV,QAAAD,CACJ,CAAG,CACH,CAMA,SAAST,GAAa,CACpBR,EAAO,UAAU,OAAO,QAAQ,CAClC,CACA,SAASe,GAAa,CACpBf,EAAO,UAAU,IAAI,QAAQ,CAC/B,CAEA,SAASmB,GAAc,CACrBlB,EAAY,UAAU,OAAO,QAAQ,CACvC,CACA,SAASQ,GAAc,CACrBR,EAAY,UAAU,IAAI,QAAQ,CACpC,CAEA,SAASW,GAAwB,CAC3BT,GAAQC,GACVK,IACAK,EAAU,4DAA4D,GAEtEK,GAEJ,CAEA,SAASR,EAAYjB,EAAQ,CAC3BK,EAAQ,mBAAmB,YAAaN,EAAcC,CAAM,CAAC,EAC7DE,EAAS,QAAO,CAClB"}